{% extends "stories/base.html" %}
{% block title %}NAHB - Stories{% endblock %}

{% block content %}
  <div class="hero">
    <div class="h1">Published stories</div>
    <div class="muted">Loaded from Flask API: <code>/stories?status=published</code></div>

    <div class="row" style="margin-top:14px;">
      <a class="btn primary" href="{% url 'story_create' %}">ï¼‹ Create story</a>
      <a class="btn" href="{% url 'stats' %}">ğŸ“Š View stats</a>
    </div>

    {% if error %}
      <div class="msg error" style="margin-top:14px;">{{ error }}</div>
    {% endif %}
  </div>

  {% if stories and stories|length > 0 %}
    <div class="grid cards">
      {% for s in stories %}
        <div class="card">
          <div class="cardHeader">
            <div>
              <p class="title">{{ s.title }}</p>
              <p class="desc">{{ s.description|default:"(no description)" }}</p>

              <div class="pillRow">
                <span class="pill"><span class="dot {% if s.status == 'published' %}ok{% else %}warn{% endif %}"></span>{{ s.status }}</span>
                <span class="pill"><span class="dot"></span>id: {{ s.id }}</span>
                <span class="pill"><span class="dot"></span>start: {{ s.start_page_id|default:"-" }}</span>
              </div>
            </div>

            <a class="btn primary" href="{% url 'play_start' s.id %}">â–¶ Play</a>
          </div>

          <div class="row">
            <a class="btn" href="{% url 'story_builder' s.id %}">ğŸ§± Build</a>
            <a class="btn" href="{% url 'story_edit' s.id %}">âœï¸ Edit</a>
            <a class="btn danger" href="{% url 'story_delete' s.id %}">ğŸ—‘ Delete</a>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="card">
      <p class="title">No published stories yet</p>
      <p class="desc">Create one and start building pages + choices.</p>
      <div class="row">
        <a class="btn primary" href="{% url 'story_create' %}">ï¼‹ Create story</a>
      </div>
    </div>
  {% endif %}
{% endblock %}
